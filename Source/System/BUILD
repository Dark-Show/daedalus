cc_library(
    name = "System",
    srcs = [
        "CompressedStream.cpp",
        "DataSink.cpp",
        "IO.cpp",
        "Paths.cpp",
    ] + select({
        "//:darwin": [
            "Posix/Condition.cpp",
            "Posix/IO.cpp",
            "Posix/Thread.cpp",
            "Posix/Timing.cpp",
        ],
        "//:windows": [
            "Windows/Condition.cpp",
            "Windows/IO.cpp",
            "Windows/Thread.cpp",
            "Windows/Timing.cpp",
        ],
    }),
    hdrs = [
        "AtomicPrimitives.h",
        "CompressedStream.h",
        "Condition.h",
        "DataSink.h",
        "Endian.h",
        "IO.h",
        "Mutex.h",
        "Paths.h",
        "SpinLock.h",
        "Thread.h",
        "Timing.h",
    ],
    visibility = ["//visibility:public"],
    deps = [
        "//Base",
        "@com_google_absl//absl/strings",
        "@zlib//:minizip",
        "@zlib//:zlib",
    ],
)

cc_test(
    name = "IO_test",
    size = "small",
    srcs = [
        "IO_test.cpp",
    ],
    visibility = ["//visibility:private"],
    deps = [
        ":System",
        "@com_google_googletest//:gtest_main",
    ],
)
